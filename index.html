<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>윗사람에 대한 존경 (대요리문답 127문)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            line-height: 1.7;
        }
        h1, h2, h3 {
            font-weight: 700;
        }
        .chapter-content ul {
            list-style-position: inside;
            padding-left: 1rem;
        }
        .chapter-content li {
            margin-bottom: 0.5rem;
        }
        .chapter-content strong {
            color: #1e40af; /* Tailwind's blue-800 */
        }
        .ask-question-btn {
            background-color: #3b82f6; /* Tailwind's blue-500 */
            color: white;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            margin-top: 1.5rem;
            transition: background-color 0.2s;
        }
        .ask-question-btn:hover {
            background-color: #2563eb; /* Tailwind's blue-600 */
        }
        #qaModal {
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 50;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto max-w-4xl p-6 md:p-10">
        <header class="mb-10 text-center">
            <h1 class="text-4xl font-bold text-gray-900 mb-2">윗사람에 대한 존경 (대요리문답 127문)</h1>
            <p class="text-lg text-gray-600">제5계명에 근거한 아랫사람의 의무에 대한 강의 노트</p>
        </header>

        <main class="space-y-12">
            <section id="chapter-1">
                <h2 class="text-2xl font-bold border-b-2 border-blue-600 pb-2 mb-4">제1장: 서론 - 제5계명의 포괄적 적용</h2>
                <div class="chapter-content text-base space-y-4">
                    <p>제5계명은 단순히 가정 내 부모와 자녀 관계에만 국한되지 않는다. 이 계명의 원리는 사회 전반의 모든 <strong>윗사람과 아랫사람 관계</strong>, 그리고 더 나아가 다양한 지위와 역할을 가진 모든 사람들 사이의 관계에 포괄적으로 적용된다.</p>
                    <p>이 강의 노트는 이러한 관계들 속에서 아랫사람이 윗사람에게 구체적으로 어떻게 합당한 존경을 표해야 하는지에 초점을 맞춘다. 대요리문답 127항은 아랫사람이 윗사람에게 표해야 할 '마땅한 존경'의 실천 방안을 7가지로 제시하고, 그 궁극적인 목적을 설명한다.</p>
                </div>
                <button class="ask-question-btn" data-chapter-title="제1장: 서론 - 제5계명의 포괄적 적용">이해를 돕는 질문하기</button>
            </section>

            <section id="chapter-2">
                <h2 class="text-2xl font-bold border-b-2 border-blue-600 pb-2 mb-4">제2장: 존경을 표현하는 7가지 방식</h2>
                <div class="chapter-content text-base space-y-6">
                    <div class="space-y-4">
                        <h3>1. 내적, 외적 공경</h3>
                        <p>존경은 마음에서 우러나와야 하며, 이것이 말과 행동으로 일관되게 표현되어야 한다. 진실한 존경의 마음을 가지고, 이에 합당한 표현, 공손한 어투, 그리고 존중이 담긴 몸짓, 표정, 자세를 통해 존경을 나타내야 한다.</p>
                        
                        <h3>2. 기도와 감사</h3>
                        <p>윗사람이 합당한 권위로 행하는 여러 일에 대하여 하나님과 당사자에게 감사를 표해야 한다. 또한, 그들의 역할과 권위가 더욱 견고해지도록 하나님의 도우심을 구하며 기도해야 한다.</p>

                        <h3>3. 덕과 은혜의 모방</h3>
                        <p>윗사람이 보여주는 좋은 성품과 신앙적 열매들을 본받아야 한다. 이는 윗사람의 권위 때문에 단순히 복종하는 것을 넘어, 그의 덕과 은혜를 배우려는 마음으로 순종해야 함을 의미한다.</p>
                        <ul>
                            <li><strong>덕스러운 행위:</strong> 정직, 근면, 신중, 절제, 인내, 공평, 공의와 같은 도덕적 품성.</li>
                            <li><strong>은혜들:</strong> 성령의 열매인 사랑, 희락, 화평, 오래 참음, 자비, 양선, 온유, 절제 등.</li>
                        </ul>

                        <h3>4. 합법적 명령에 대한 즐거운 순종</h3>
                        <p>윗사람의 명령이나 권면이 <strong>'합법적'</strong>일 경우, 즉 하나님의 법에 일치할 때는 기꺼이, 그리고 즐거운 마음으로 순종해야 한다. 마음이 담기지 않은 겉치레 순종이 아닌, 진심으로 순종해야 하는 이유는, 합법적인 권위에 대한 순종이 곧 하나님께 순종하는 행위와 같기 때문이다.</p>

                        <h3>5. 교정에 대한 겸손한 복종</h3>
                        <p>윗사람으로부터 하나님의 교훈에 합당한 꾸짖음이나 교정을 받을 때, 화를 내거나 완고하게 자신을 변호해서는 안 된다. 자신의 허물과 잘못을 인정하고 징계를 겸손하게 받아들여야 한다.</p>

                        <h3>6. 인격과 권위에 대한 충성</h3>
                        <p>윗사람은 개인 인격을 넘어 하나님께서 권위를 부여하신 신분과 지위를 가진 존재임을 인식해야 한다. 따라서 그들의 인격과 권위를 충성스럽게 지지하고 보호해야 한다. 윗사람의 권위가 부당하게 침해받을 경우, 이를 지키고 오히려 그 권위가 존중받도록 힘써야 한다.</p>
                        
                        <h3>7. 연약함에 대한 인내와 사랑의 덮음</h3>
                        <p>윗사람 또한 타락한 본성으로 인해 연약함과 죄를 피할 수 없는 존재다. 여기서 <strong>'연약함'</strong>은 노골적인 악행이나 명백한 불법 행위가 아닌, 성격상의 결점이나 약점을 의미한다. 이러한 연약함을 빌미로 존경심을 거두어서는 안 되며, 오히려 인내하며 참고 사랑으로 그 허물을 덮어주어야 한다.</p>
                    </div>
                </div>
                <button class="ask-question-btn" data-chapter-title="제2장: 존경을 표현하는 7가지 방식">이해를 돕는 질문하기</button>
            </section>

            <section id="chapter-3">
                <h2 class="text-2xl font-bold border-b-2 border-blue-600 pb-2 mb-4">제3장: 존경의 궁극적인 목적</h2>
                <div class="chapter-content text-base space-y-4">
                    <p>앞서 설명한 7가지 존경의 표현 방식은 궁극적으로 한 가지 목표를 향한다. 그것은 바로 <strong>윗사람 개인과 그들의 다스림(리더십)이 명예롭게 되도록 하는 것</strong>이다.</p>
                    <p>아랫사람이 윗사람을 합당하게 존경하여 세워주는 것은, 그 권위를 세우신 하나님께 영광을 돌리는 마땅한 행위이다. 만약 그렇게 하지 않는다면, 하나님의 이름을 빛내지 못하게 하는 잘못을 범하는 것이다.</p>
                </div>
                <button class="ask-question-btn" data-chapter-title="제3장: 존경의 궁극적인 목적">이해를 돕는 질문하기</button>
            </section>
            
            <section id="chapter-4">
                <h2 class="text-2xl font-bold border-b-2 border-blue-600 pb-2 mb-4">제4장: 관련 성경 구절</h2>
                <div class="chapter-content text-sm space-y-4 bg-gray-100 p-6 rounded-lg">
                    <p><strong>말라기 1:6</strong> "내 이름을 멸시하는 제사장들아 나 만군의 여호와가 너희에게 이르기를 아들은 그 아버지를, 종은 그 주인을 공경하나니 내가 아버지일진대 나를 공경함이 어디 있느냐 내가 주인일진대 나를 두려워함이 어디 있느냐..."</p>
                    <p><strong>디모데전서 2:1-2</strong> "그러므로 내가 첫째로 권하노니 모든 사람을 위하여 간구와 기도와 도고와 감사를 하되 임금들과 높은 지위에 있는 모든 사람을 위하여 하라..."</p>
                    <p><strong>히브리서 13:7</strong> "하나님의 말씀을 너희에게 일러 주고 너희를 인도하던 자들을 생각하며 그들의 행실의 결말을 주의하여 보고 그들의 믿음을 본받으라"</p>
                    <p><strong>히브리서 12:9</strong> "또 우리 육신의 아버지가 우리를 징계하여도 공경하였거든 하물며 모든 영의 아버지께 더욱 복종하며 살려 하지 않겠느냐"</p>
                    <p><strong>베드로전서 2:18</strong> "사환들아 범사에 두려워함으로 주인들에게 순종하되 선하고 관용하는 자들에게만 아니라 또한 까다로운 자들에게도 그리하라"</p>
                </div>
                <button class="ask-question-btn" data-chapter-title="제4장: 관련 성경 구절">이해를 돕는 질문하기</button>
            </section>
        </main>
    </div>

    <div id="qaModal" class="fixed inset-0 flex items-center justify-center p-4 hidden">
        <div class="absolute inset-0 bg-black opacity-50" id="modal-overlay"></div>
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl z-10 flex flex-col" style="max-height: 90vh;">
            <header class="p-4 border-b flex justify-between items-center">
                <h3 id="modalTitle" class="text-xl font-bold text-gray-800">질문하기</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-800">&times;</button>
            </header>
            
            <div id="modalContext" class="hidden"></div>
            <div id="modalChapterTitle" class="hidden"></div>

            <div id="chatHistory" class="p-4 flex-grow overflow-y-auto space-y-4">
                </div>

            <footer class="p-4 border-t bg-gray-50">
                <div class="flex space-x-2">
                    <textarea id="questionInput" class="flex-grow p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none" rows="2" placeholder="이 장의 내용에 대해 질문을 입력하세요..."></textarea>
                    <button id="submitQuestion" class="bg-blue-600 text-white font-semibold px-4 py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-300">전송</button>
                </div>
            </footer>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const qaModal = document.getElementById('qaModal');
            const closeModalBtn = document.getElementById('closeModal');
            const modalOverlay = document.getElementById('modal-overlay');
            const askQuestionBtns = document.querySelectorAll('.ask-question-btn');
            const modalTitle = document.getElementById('modalTitle');
            const modalContext = document.getElementById('modalContext');
            const modalChapterTitle = document.getElementById('modalChapterTitle');
            const submitQuestionBtn = document.getElementById('submitQuestion');
            const questionInput = document.getElementById('questionInput');
            const chatHistory = document.getElementById('chatHistory');

            const openModal = (chapterTitle, chapterContent) => {
                modalTitle.textContent = `질문하기: ${chapterTitle}`;
                modalContext.textContent = chapterContent;
                modalChapterTitle.textContent = chapterTitle;
                chatHistory.innerHTML = `<div class="bg-blue-100 text-blue-800 p-3 rounded-lg text-sm"><strong>안내:</strong> '${chapterTitle}' 장의 내용에 기반하여 질문에 답변해 드립니다.</div>`;
                questionInput.value = '';
                qaModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            };

            const closeModal = () => {
                qaModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            };

            askQuestionBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const chapterSection = btn.closest('section');
                    const chapterTitle = btn.dataset.chapterTitle;
                    const chapterContentElement = chapterSection.querySelector('.chapter-content');
                    const chapterContent = chapterContentElement.innerText;
                    openModal(chapterTitle, chapterContent);
                });
            });

            closeModalBtn.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', closeModal);
            
            questionInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' && !event.shiftKey) {
                    event.preventDefault();
                    submitQuestionBtn.click();
                }
            });

            submitQuestionBtn.addEventListener('click', async () => {
                const userQuestion = questionInput.value.trim();
                if (!userQuestion) return;

                const chapterContext = modalContext.textContent;
                const chapterTitleText = modalChapterTitle.textContent;
                
                const finalPrompt = `
                    당신은 신학적 질문에 답변하는 전문 AI 어시스턴트입니다. 아래에 명시된 두 가지 규칙의 우선순위를 반드시 지켜서 사용자의 질문에 답변해 주세요.

                    [규칙 1: 주어진 자료 우선의 원칙]
                    - 최우선적으로, 아래에 제공되는 "[강의 노트 내용]"에 근거하여 답변을 생성해야 합니다.
                    - 자료에 명시된 사실과 논리를 바탕으로 질문에 직접적으로 답해주세요.

                    [규칙 2: 신학적 보충의 원칙]
                    - 만약 "[강의 노트 내용]"만으로 답변하기에 정보가 불충분하거나 관련 내용이 없을 경우에만, '전통적 개혁신학'의 관점에서 답변을 보충할 수 있습니다.
                    - 이 경우, 답변이 주어진 자료에서 나온 것이 아님을 명확히 하기 위해 "강의 노트 내용에 직접 언급되지는 않았지만, 전통적 개혁신학의 관점에서 볼 때..."와 같이 서술을 시작해주세요.

                    ---
                    [강의 노트 제목]: ${chapterTitleText}
                    ---
                    [강의 노트 내용]:
                    ${chapterContext}
                    ---
                    [사용자 질문]:
                    ${userQuestion}
                `;

                appendMessage(userQuestion, 'user');
                questionInput.value = '';
                submitQuestionBtn.disabled = true;

                appendMessage('답변을 생성 중입니다...', 'loading');

                try {
                    const response = await fetch('/api/ask-gemini', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ prompt: finalPrompt }),
                    });

                    if (!response.ok) {
                        throw new Error(`Server error: ${response.status} ${response.statusText}`);
                    }

                    const data = await response.json();
                    
                    const loadingElement = chatHistory.querySelector('.message-loading');
                    if (loadingElement) loadingElement.remove();

                    if (data && data.candidates && data.candidates.length > 0 && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0 && data.candidates[0].content.parts[0].text) {
                        const answer = data.candidates[0].content.parts[0].text;
                        appendMessage(answer, 'ai');
                    } else {
                        appendMessage('죄송합니다. 응답에서 답변을 추출할 수 없습니다. 형식이 예상과 다릅니다.', 'error');
                        console.error("Unexpected API response structure:", data);
                    }

                } catch (error) {
                    const loadingElement = chatHistory.querySelector('.message-loading');
                    if (loadingElement) loadingElement.remove();
                    appendMessage(`오류가 발생했습니다: ${error.message}. 잠시 후 다시 시도해주세요.`, 'error');
                    console.error('Fetch error:', error);
                } finally {
                    submitQuestionBtn.disabled = false;
                    questionInput.focus();
                }
            });

            function appendMessage(text, type) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message', `message-${type}`, 'w-full', 'flex', 'flex-col', 'items-start');
                
                let html = '';
                switch (type) {
                    case 'user':
                        messageDiv.classList.add('items-end');
                        html = `<div class="bg-gray-200 text-gray-800 p-3 rounded-lg max-w-lg">${text.replace(/\n/g, '<br>')}</div>`;
                        break;
                    case 'ai':
                        html = `<div class="bg-blue-500 text-white p-3 rounded-lg max-w-lg">${text.replace(/\n/g, '<br>')}</div>`;
                        break;
                    case 'loading':
                        html = `<div class="bg-gray-300 text-gray-600 p-3 rounded-lg max-w-lg animate-pulse">● ● ●</div>`;
                        break;
                    case 'error':
                        messageDiv.classList.add('items-center');
                        html = `<div class="bg-red-100 text-red-700 p-3 rounded-lg text-sm">${text}</div>`;
                        break;
                }
                
                messageDiv.innerHTML = html;
                chatHistory.appendChild(messageDiv);
                chatHistory.scrollTop = chatHistory.scrollHeight;
            }
        });
    </script>
</body>
</html>
